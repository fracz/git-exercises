<?php
namespace GitExercises\hook\verifications;

use GitExercises\hook\AbstractVerification;
use GitExercises\hook\utils\GitUtils;

class MoreConflicts extends AbstractVerification
{
    protected function doVerify()
    {
        $mergeCommit = $this->ensureCommitsCount(4)[0];
        $parents = GitUtils::getParents($mergeCommit);
        $this->ensure(count($parents) == 2, 'The last commit should be a merge commit.');
        $adds = implode("\n", $this->getFileContent($mergeCommit, 'additions.txt'));
        $subs = implode("\n", $this->getFileContent($mergeCommit, 'subs.txt'));
        $this->ensure(! (strpos($adds, "<") || strpos($adds, ">") || strpos($adds, "==") ), "Did you leave conflict marks?");
        $this->ensure(! (strpos($subs, "<") || strpos($subs, ">") || strpos($subs, "==") ), "Did you leave conflict marks?");
        $this->ensure($adds == "934 + 6339 = 7273\n18505 + 17201 = 35706\n12172 + 27394 = 39566\n2247 + 26966 = 29213\n32504 + 9058 = 41562\n7619 + 12380 = 19999\n3239 + 13605 = 16844\n9105 + 6193 = 15298\n25368 + 4386 = 29754\n26352 + 16196 = 42548\n23671 + 23237 = 46908\n28889 + 13536 = 42425\n26324 + 4540 = 30864\n11585 + 22039 = 33624\n9922 + 19456 = 29378\n24341 + 13292 = 37633\n21016 + 14311 = 35327\n31016 + 19745 = 50761\n20943 + 25628 = 46571\n1368 + 16613 = 17981\n534 + 9372 = 9906\n13542 + 21478 = 35020\n26027 + 7592 = 33619\n24700 + 8963 = 33663\n20535 + 28649 = 49184\n8471 + 27315 = 35786\n7792 + 22259 = 30051\n7766 + 10114 = 17880\n24607 + 29894 = 54501\n10421 + 28250 = 38671\n19295 + 15972 = 35267\n22430 + 26322 = 48752\n31785 + 22084 = 53869\n13836 + 17136 = 30972\n3156 + 29016 = 32172\n25178 + 355 = 25533\n20758 + 28156 = 48914\n17510 + 4770 = 22280\n8010 + 4615 = 12625\n13582 + 24973 = 38555\n24204 + 32572 = 56776\n30960 + 1782 = 32742\n12019 + 21638 = 33657\n20246 + 18817 = 39063\n13686 + 28522 = 42208\n21201 + 16642 = 37843\n4567 + 7896 = 12463\n16002 + 24293 = 40295\n12861 + 21565 = 34426\n29211 + 23055 = 52266\n9700 + 22131 = 31831\n30574 + 23287 = 53861\n20902 + 8842 = 29744\n8357 + 317 = 8674\n32588 + 7941 = 40529\n14742 + 17700 = 32442\n23140 + 6198 = 29338\n26235 + 2713 = 28948\n15721 + 23447 = 39168\n32647 + 814 = 33461\n8155 + 11950 = 20105\n15444 + 10948 = 26392\n22914 + 26632 = 49546\n23247 + 12940 = 36187\n28843 + 10645 = 39488\n4875 + 27624 = 32499\n29344 + 20738 = 50082\n7048 + 13599 = 20647\n150 + 32693 = 32843\n15241 + 26129 = 41370\n25972 + 1915 = 27887\n16553 + 30003 = 46556\n10785 + 9060 = 19845\n22562 + 21506 = 44068\n21732 + 17770 = 39502\n15492 + 5415 = 20907\n25 + 1611 = 1636\n30964 + 31112 = 62076\n15733 + 16147 = 31880\n22384 + 13172 = 35556\n29860 + 28201 = 58061\n4812 + 2027 = 6839\n16675 + 6481 = 23156\n30247 + 6582 = 36829\n724 + 6918 = 7642\n11072 + 26047 = 37119\n11191 + 26237 = 37428\n32758 + 15109 = 47867\n10628 + 20205 = 30833\n14418 + 7956 = 22374\n3320 + 2020 = 5340\n22466 + 29419 = 51885\n23762 + 23529 = 47291\n19159 + 26040 = 45199\n26389 + 19601 = 45990\n2088 + 29408 = 31496\n1967 + 13605 = 15572\n26354 + 25405 = 51759\n11797 + 8635 = 20432\n26314 + 24473 = 50787", "Something is wrong double-check your calculations");
        $this->ensure($subs == "4498 - 4316 = 182\n8139 - 13413 = -5274\n4190 - 17299 = -13109\n8810 - 20056 = -11246\n2678 - 28630 = -25952\n23522 - 27228 = -3706\n267 - 8854 = -8587\n13753 - 18566 = -4813\n3995 - 23352 = -19357\n10443 - 17727 = -7284\n18492 - 26611 = -8119\n11076 - 22230 = -11154\n21476 - 1176 = 20300\n27062 - 16390 = 10672\n4851 - 21989 = -17138\n22442 - 12431 = 10011\n8941 - 27284 = -18343\n4333 - 21247 = -16914\n18256 - 30609 = -12353\n4929 - 2381 = 2548\n31574 - 25238 = 6336\n27555 - 29355 = -1800\n6620 - 13085 = -6465\n28332 - 11740 = 16592\n30629 - 615 = 30014\n15258 - 6678 = 8580\n6593 - 29753 = -23160\n6811 - 24329 = -17518\n14822 - 19351 = -4529\n24873 - 12283 = 12590\n23788 - 8757 = 15031\n24092 - 10494 = 13598\n21710 - 30939 = -9229\n21021 - 26883 = -5862\n22051 - 18067 = 3984\n29239 - 1997 = 27242\n24620 - 25801 = -1181\n6775 - 21336 = -14561\n32382 - 28932 = 3450\n20913 - 5126 = 15787\n66 - 25644 = -25578\n4757 - 28093 = -23336\n15938 - 32414 = -16476\n15796 - 21157 = -5361\n10671 - 24619 = -13948\n32568 - 15249 = 17319\n1195 - 21995 = -20800\n8088 - 18449 = -10361\n9544 - 27843 = -18299\n19285 - 21436 = -2151\n362 - 22636 = -22274\n10665 - 31350 = -20685\n1062 - 31303 = -30241\n14441 - 18825 = -4384\n30586 - 23802 = 6784\n8292 - 6141 = 2151\n20963 - 29668 = -8705\n21867 - 18814 = 3053\n9939 - 20007 = -10068\n10602 - 25624 = -15022\n5105 - 9394 = -4289\n10751 - 40 = 10711\n20270 - 342 = 19928\n31454 - 10751 = 20703\n11326 - 31059 = -19733\n22850 - 7890 = 14960\n32436 - 4648 = 27788\n17041 - 3663 = 13378\n21340 - 26142 = -4802\n1054 - 20398 = -19344\n9184 - 15387 = -6203\n26260 - 878 = 25382\n4697 - 22796 = -18099\n5409 - 16241 = -10832\n29957 - 20303 = 9654\n8175 - 24778 = -16603\n22103 - 31674 = -9571\n15301 - 32285 = -16984\n17490 - 2827 = 14663\n3653 - 26909 = -23256\n8480 - 30767 = -22287\n26003 - 10190 = 15813\n3804 - 23784 = -19980\n9139 - 9452 = -313\n15209 - 21367 = -6158\n878 - 1378 = -500\n30247 - 4601 = 25646\n15570 - 7427 = 8143\n16799 - 31441 = -14642\n28524 - 20872 = 7652\n8030 - 6978 = 1052\n29921 - 19768 = 10153\n15416 - 31126 = -15710\n17503 - 15934 = 1569\n8860 - 24692 = -15832\n15244 - 1276 = 13968\n16100 - 10508 = 5592\n14798 - 5571 = 9227\n25315 - 15963 = 9352\n25203 - 11043 = 14160", "Something is wrong double-check your calculations");
    }
}
